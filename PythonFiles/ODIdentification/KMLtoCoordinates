from pykml import parser
import csv

coors = []
with open("(NOVA) OD Map by Region.kml", 'r') as file:

    doc = parser.parse(file).getroot().Document

    for folder in doc.Folder:

        folderName = str(folder.name)
        pointCount = 0

        if folderName.__contains__("Nodes"):

            for placemark in folder.Placemark:
                pointCount += 1

                c = placemark.Point.coordinates
                c = str(c).strip().split(",")

                coor = [c[1], c[0], folderName[7:folderName.__len__() - 7], "NOVA"]
                coors.append(coor)

file.close()

with open("(DC) OD Map by Region.kml", 'r') as file:

    doc = parser.parse(file).getroot().Document

    for folder in doc.Folder:

        folderName = str(folder.name)
        pointCount = 0

        if folderName.__contains__("Nodes"):

            for placemark in folder.Placemark:
                pointCount += 1

                c = placemark.Point.coordinates
                c = str(c).strip().split(",")

                coor = [c[1], c[0], folderName[:folderName.__len__() - 6], "DC"]
                coors.append(coor)

file.close()

with open("GridToRegion.csv", 'w', newline='') as file:

    writer = csv.writer(file)

    writer.writerow(["Lat", "Long", "Region", "Grid"])

    writer.writerows(coors)
file.close()


# end of file

